-- Query to determine the prac's to be used for a provider

SELECT * FROM PORTOWN.PP_PRAC_LOC ppl WHERE ppl.PROV_ID = 10963

SELECT * FROM PORTOWN.PP_PRAC pp WHERE pp.id = 108468

SELECT * FROM PORTOWN.PP_ADDR pa WHERE pa.id IN (
SELECT ppa.ADDRESS_ID FROM PORTOWN.PP_PRAC_ADDR ppa WHERE ppa.PRAC_ID  = 108468
)

SELECT * FROM PORTOWN.PP_PHONES ppp WHERE ppp.id in (
SELECT pap.PHONE_ID FROM PORTOWN.PP_ADDR_PHONES pap WHERE pap.ADDRESS_ID in (
SELECT ppa.ADDRESS_ID FROM PORTOWN.PP_PRAC_ADDR ppa WHERE ppa.PRAC_ID  = 108468)
)


SELECT * FROM PORTOWN.PP_ADDR_PHONES pap WHERE pap.ADDRESS_ID in (SELECT ppa.ADDRESS_ID FROM PORTOWN.PP_PRAC_ADDR ppa WHERE ppa.PRAC_ID  = 108468)

SELECT * FROM PORTOWN.PP_PRAC_ADDR ppa WHERE ppa.PRAC_ID  = 108468

SELECT * FROM PORTOWN.PP_ADDR pa WHERE pa.id IN (
SELECT pptl.ADDRESS_ID FROM PORTOWN.PP_PROV_TIN_LOC pptl WHERE pptl.id IN (
SELECT ppl.loc_id FROM PORTOWN.PP_PRAC_LOC ppl WHERE ppl.PROV_ID = 10963 AND ppl.PRAC_ID = 108468)
)

SELECT * FROM PORTOWN.PP_PROV_TIN_LOC pptl WHERE pptl.id IN (
SELECT ppl.loc_id FROM PORTOWN.PP_PRAC_LOC ppl WHERE ppl.PROV_ID = 10963 AND ppl.PRAC_ID = 108468
)

SELECT * FROM PORTOWN.PP_PRAC_LOC ppl WHERE ppl.PROV_ID = 10963 AND ppl.PRAC_ID = 108468

SELECT * FROM PORTOWN.PP_PRAC_NET_CYCLE ppnc WHERE ppnc.PRAC_ID = 108468 AND ppnc.id IN (
SELECT ppnlc.PRAC_NET_CYCLE_ID FROM PORTOWN.PP_PRAC_NET_LOC_CYCLE ppnlc WHERE ppnlc.PROV_ID = 10963 AND ppnlc.PRAC_ID = 108468
)

SELECT * FROM PORTOWN.PP_PRAC_NET_LOC_CYCLE ppnlc WHERE ppnlc.PROV_ID = 10963 AND ppnlc.PRAC_ID = 108468

SELECT * FROM PORTOWN.PP_PRAC_ATTRIB ppa WHERE ppa.PRAC_ID = 108468 AND ppa.ATTRIBUTE_ID IN (501, 101619, 100085, 100084, 
103279, 100043, 100051, 103877, 100039, 101977, 101957, 100052
)

SELECT * FROM PORTOWN.PP_PRAC_ATTRIB_VALUES ppav WHERE ppav.PRAC_ATTRIBUTE_ID IN
(SELECT ppa.ID FROM PORTOWN.PP_PRAC_ATTRIB ppa WHERE ppa.PRAC_ID = 108468 AND ppa.ATTRIBUTE_ID IN (501, 101619, 100085, 100084, 
103279, 100043, 100051, 103877, 100039, 101977, 101957, 100052)
)

SELECT * FROM PORTOWN.PP_PRAC_LOC_ATTRIB ppla WHERE ppla.PRAC_ID = 108468 AND ppla.PROV_ID = 10963 AND ppla.ATTRIBUTE_ID IN (107097)

SELECT * FROM PORTOWN.PP_PRAC_LOC_ATTRIB_VALUES pplav WHERE pplav.PRAC_LOC_ATTRIBUTE_ID IN
(SELECT ppla.id FROM PORTOWN.PP_PRAC_LOC_ATTRIB ppla WHERE ppla.PRAC_ID = 108468 AND ppla.PROV_ID = 10963 AND ppla.ATTRIBUTE_ID IN (107097))
